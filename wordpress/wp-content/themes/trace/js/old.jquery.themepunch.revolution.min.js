/**************************************************************************
 * jquery.themepunch.kenburn.js - jQuery Plugin for kenburn Slider
 * @version: 2.0 (09.02.2012)
 * @requires jQuery v1.2.2 or later 
 * @author Krisztian Horvath
**************************************************************************/




(function($,undefined){	
	
	
	
	////////////////////////////
	// THE PLUGIN STARTS HERE //
	////////////////////////////
	
	$.fn.extend({
	
		
		// OUR PLUGIN HERE :)
		simple: function(options) {
	
		
			
		////////////////////////////////
		// SET DEFAULT VALUES OF ITEM //
		////////////////////////////////
		var defaults = {	
			delay:3000,
			startwidth:1020,
			startheight:350,
			bulletContainer:'#bullets',
			bulletTyp:"simple",
			bulletThumbsWidth:120,
			bulletThumbsHeight:70,
			hideThumbs:300
		};
		
			options = $.extend({}, $.fn.simple.defaults, options);
		
				
					
			return this.each(function() {
											
				var opt=options;
				
				
				opt.slots=4;
				opt.act=-1;
				opt.next=0;
				
				var container=$(this);
				opt.container=container;
				
				
				opt.bw = opt.startwidth / container.width();
				opt.bh = opt.startheight / container.height();
				
				
				
				opt.slideamount = container.find('ul:first li').length;
				
				
				opt.width=container.width();
				opt.height=container.height();
				
				if (opt.width!=opt.startwidth) {
					
					opt.height = Math.round(opt.startheight * (opt.width/opt.startwidth));
					container.height(opt.height);
					
				}
				container.waitForImages(function() {
						container.cssAnimate({'opacity':1});
						// PREPARE THE SLIDES
						prepareSlides(container,opt);				
						
						
						
				});
			})
		}

})

		//////////////////////////
		//	CONTAINER RESIZED	//
		/////////////////////////
		function containerResized(container,opt) {
			
			
			container.find('.defaultimg').each(function() {
						
						setSize($(this),opt);
						
						opt.height = Math.round(opt.startheight * (opt.width/opt.startwidth));
						container.height(opt.height);															
						
						
						var actsh = container.find('li:eq('+opt.act+') .slotholder');
						var nextsh = container.find('li:eq('+opt.next+') .slotholder');
						removeSlots(container);
						
						//nextsh.find('.defaultimg').css({'opacity':0});
						//actsh.find('.defaultimg').css({'opacity':1});
						
						setCaptionPositions(container,opt);
						
						var nextli = container.find('li:eq('+opt.next+')');
						container.find('.caption').each(function() { $(this).stop(true,true);});
						animateTheCaptions(nextli, opt);		
						
						var bullets = $('body').find(opt.bulletContainer);
						
						if (opt.bulletTyp=="long") {									
								opt.bulletThumbsWidth = (-1+(container.parent().outerWidth() / opt.slideamount));
								opt.bulletThumbsHeight = (opt.bulletThumbsWidth/opt.oldBTW) * opt.oldBTH;								
								bullets.find('.thumbdecorholder').css({'width':opt.bulletThumbsWidth+"px", 'height':opt.bulletThumbsHeight+"px"});
								bullets.find('.bulletthumb').each(function() {
								$(this).css({'width':opt.bulletThumbsWidth+"px", 'height':opt.bulletThumbsHeight+"px"});
						});
						} 
						
						bullets.find('.bullet').each(function() {
							var bul = $(this);
							bul.css({'width':(-1+(container.parent().outerWidth() / opt.slideamount))+"px"});
						});
						
						opt.cd=0;
						try{
							var bt=container.find('.bannertimer');
							if (bt.length>0) {
								bt.css({'width':'0%'});
								bt.animate({'width':"100%"},{duration:(opt.delay-100),queue:false, easing:"linear"});
							}
						} catch(e) {}
						
						
						
				});
		}
		
		
		
		
		
		
		
		////////////////////////////////
		//	-	CREATE THE BULLETS -  //
		////////////////////////////////
		function createBullets(container,opt) {
			
			var bullets = $('body').find(opt.bulletContainer);
			//	ADD THUMBNAIL IMAGES FOR THE BULLETS //
			
			
			
			// SET THE RIGHT CLASS FIRST FOR THE BULLETS
			if (opt.bulletTyp=="round") 
				bullets.addClass('tp-roundbullets');
			else
				if (opt.bulletTyp=="long") 
					bullets.addClass('tp-longbullets');
				else
					if (opt.bulletTyp=="simple") 
						bullets.addClass('tp-simplebullets');
					else 
						if (opt.bulletTyp=="full") 
							bullets.addClass('tp-fullbullets');
		
			try {
			opt.oldBTW = opt.bulletThumbsWidth;
			opt.oldBTH = opt.bulletThumbsHeight;
			} catch(e) { }
			
		
			
			
			if (opt.bulletTyp=="round" || opt.bulletTyp=="long" || opt.bulletTyp=="simple" || opt.bulletTyp=="full")  {
				// ADD BULLETS HERE
				container.find('ul:first li').each(function(i) {
							if (opt.bulletTyp=="full") {
								bullets.append('<div class="bullet"><div class="btitle">'+$(this).data("thumbtitle")+'</div><div class="bdesc">'+$(this).data("thumbdesc")+'</div></div>');				
							}  else {							
								bullets.append('<div class="bullet"></div>');				
							}							
				});
				var bullet= bullets.find('.bullet:first');				
			}
			
			
			// ADD THE BULLETS HERE
			var mwidth = 0;
			bullets.find('.bullet').each(function(i) {
				var bul = $(this);
				if (opt.bulletTyp=="long" || opt.bulletTyp=="full") 
					bul.css({'width':(-1+(container.outerWidth() / opt.slideamount))+"px"});
				if (i==0) bul.addClass('first');
				if (i==opt.slideamount-1) bul.addClass('last');
				
				mwidth += ((container.outerWidth() / opt.slideamount));
				
				
				
				bul.click(function() {
					
					if (opt.transition==0 && bul.index() != opt.act) {
						opt.next = bul.index();						
						opt.cd=0;
						swapSlide(container,opt);
						
						// STOP TIMER AND RESCALE IT 
						try{
							var bt=	container.find('.bannertimer');							
							if (bt.length>0) {
								bt.stop();
								bt.css({'width':'0%'});
								bt.animate({'width':"100%"},{duration:(opt.delay-100),queue:false, easing:"linear"});
							}
						} catch (e) {}
						
					} else {
						
					}
				});
				
			});
			
			
			bullets.find('.bullet:last').css({'marginRight':'0px'});
						
			bullets.append('<div style="clear:both"></div>');
			
			
			bullets.css({'width':'100%'});
			
			
			
			
			
			
			// SHOW AND HIDE THE THUMBS IF MOUE GOES OUT OF THE BANNER
			if (bullets.data('hidethumbs')>0) {
			
					bullets.css({'opacity':0});
					
					bullets.live('mouseenter', function() {
						var bullets=$('body').find(opt.bulletContainer);
						bullets.addClass("hovered");	
						clearTimeout(bullets.data('hidethumbs'));
						bullets.animate({'opacity':1},{duration:200,queue:false});
					});
					
					bullets.live('mouseleave', function() {
						var bullets=$('body').find(opt.bulletContainer)
						bullets.removeClass("hovered");		
						if (!container.hasClass("hovered") && !bullets.hasClass("hovered"))
							bullets.data('hidethumbs', setTimeout(function() { bullets.animate({'opacity':0},{duration:200,queue:false});},opt.hideThumbs));
					});
					
					
					
					container.live('mouseenter', function() {
						var bullets=$('body').find(opt.bulletContainer);
						bullets.addClass("hovered");	
						clearTimeout(bullets.data('hidethumbs'));
						bullets.animate({'opacity':1},{duration:200,queue:false});
					});
					
					container.live('mouseleave', function() {
						var bullets=$('body').find(opt.bulletContainer)
						bullets.removeClass("hovered");		
						if (!container.hasClass("hovered") && !bullets.hasClass("hovered"))
							bullets.data('hidethumbs', setTimeout(function() { bullets.animate({'opacity':0},{duration:200,queue:false});},opt.hideThumbs));
					});
			}
		}


		
		
		
		
		
		
		
		
		//////////////////////////////////////////////////////////
		//	-	SET THE IMAGE SIZE TO FIT INTO THE CONTIANER -  //
		////////////////////////////////////////////////////////
		function setSize(img,opt) {
		
			opt.width=parseInt(opt.container.width(),0);
			opt.height=parseInt(opt.container.height(),0);
			
			opt.bw = opt.width / opt.startwidth;
			opt.bh = opt.height / opt.startheight;
			
			// IF IMG IS ALREADY PREPARED, WE RESET THE SIZE FIRST HERE
			if (img.data('orgw')!=undefined) {
				img.width(img.data('orgw'));
				img.height(img.data('orgh'));				
			}
			
			
			var fw = opt.width / img.width();
			var fh = opt.height / img.height();
			
			
			opt.fw=fw;
			opt.fh=fh;
			
			if (img.data('orgw')==undefined) {
				img.data('orgw',img.width());
				img.data('orgh',img.height());
			}
			
				
			img.width(opt.width);
			img.height(img.height()*fw);
			
			
			if (img.height()<opt.height) {
				img.height(opt.height);
				img.width(img.data('orgw')*fh);
			}
			
			
			
			img.data('neww',img.width());
			img.data('newh',img.height());						
			opt.slotw=opt.width/opt.slots;
			
		}
		
		
		
		
			/////////////////////////////////////////
			//	-	PREPARE THE SLIDES / SLOTS -  //
			///////////////////////////////////////
			function prepareSlides(container,opt) {
			
				container.find('.caption').each(function() { $(this).addClass($(this).data('transition')); $(this).addClass('start') });
				
				var maxitem = container.find('ul:first li >img').length;
				opt.loadedslides=0;
				container.find('ul:first li >img').each(function(j) {

					var img=$(this);	
					img.addClass('defaultimg');				
					img.parent().waitForImages(function() {
						setSize(img,opt);				
						img.wrap('<div class="slotholder"></div>');
						img.css({'opacity':0});		
						img.data('li-id',j);
						opt.loadedslides++;
					
					});								
				});		

				opt.waitInterval=setInterval(function() {
					if (opt.loadedslides==maxitem) {
						
									// CREATE BULLETS
									createBullets(container,opt);
									
									// START THE FIRST SLIDE
									swapSlide(container,opt);
									
									// START COUNTDOWN
									countDown(container,opt);
									
								
									setInterval(function() {
										if (opt.width!= container.width() || opt.height!=container.height()) containerResized(container,opt);
									},100);
									
									
									// IF RESIZED, NEED TO STOP ACTUAL TRANSITION AND RESIZE ACTUAL IMAGES
									$(window).resize(function() {
										
										clearTimeout(opt.resizingit);
										opt.resizingit = setTimeout(function() {
											containerResized(container,opt);
										},200);
									});
									clearInterval(opt.waitInterval);
					}
				},100);
			}
		
		
		///////////////////////
		// PREPARE THE SLIDE //
		//////////////////////
		function prepareOneSlide(slotholder,opt,visible) {
				
				var sh=slotholder;					
				var img = sh.find('img')
				setSize(img,opt)
				var src = img.attr('src');
				var w = img.data('neww');
				var h = img.data('newh');
				var off=0;
				
				
				if (!visible) 
					var off=0-opt.slotw;
					
				for (var i=0;i<opt.slots;i++) 				
					sh.append('<div class="slot" style="position:absolute;top:0px;left:'+(i*opt.slotw)+'px;overflow:hidden;width:'+opt.slotw+'px;height:'+h+'px"><div class="slotslide" style="position:absolute;top:0px;left:'+off+'px;width:'+opt.slotw+'px;height:'+h+'px;overflow:hidden;"><img style="position:absolute;top:0px;left:'+(0-(i*opt.slotw))+'px;width:'+w+'px;height:'+h+'px" src="'+src+'"></div></div>');									
											
		}
		
		
		
		
		///////////////////////
		//	REMOVE SLOTS	//
		/////////////////////
		function removeSlots(container) {
			
			container.find('.slotholder .slot').each(function() {
				clearTimeout($(this).data('tout'));
				$(this).remove();
			});
			
		}
		
		////////////////////////
		//	CAPTION POSITION  //
		///////////////////////
		function setCaptionPositions(container,opt) {
			
			// FIND THE RIGHT CAPTIONS
			var actli = container.find('li:eq('+opt.act+')');
			var nextli = container.find('li:eq('+opt.next+')');
						
			// SET THE NEXT CAPTION AND REMOVE THE LAST CAPTION
			var nextcaption=nextli.find('.caption');
						
			// MOVE THE CAPTIONS TO THE RIGHT POSITION
			if (nextcaption.hasClass('hcenter'))
				nextcaption.css({'height':opt.height+"px",'top':'0px','left':(opt.width/2 - nextcaption.outerWidth()/2)+'px'});
			else
				if (nextcaption.hasClass('vcenter'))
					nextcaption.css({'width':opt.width+"px",'left':'0px','top':(opt.height/2 - nextcaption.outerHeight()/2)+'px'});			
		}
		
		
		
		////////////////////////////////
		//	CHECK MODERN BROWSER	//
		/////////////////////////////
		function modernBrowser() {
				var div = document.createElement('div');
				div.setAttribute('style', 'transition:top 1s ease;-webkit-transition:top 1s ease;-moz-transition:top 1s ease;-o-transition:top 1s ease;');
				document.body.appendChild(div);
				var cssTransitionsSupported = !!(div.style.webkitTransition || div.style.MozTransition || div.style.OTransitionDuration);

				div.parentNode.removeChild(div);
				div = null;

				
				return cssTransitionsSupported;

		}
		
		
		//////////////////////////////
		//                         //
		//	-	SWAP THE SLIDES -  //
		//                        //
		////////////////////////////
		function swapSlide(container,opt) {
			
			
			opt.transition = 1;
			
			var actli = container.find('li:eq('+opt.act+')');
			var nextli = container.find('li:eq('+opt.next+')');
			var actsh = actli.find('.slotholder');
			var nextsh = nextli.find('.slotholder');
			
			// RESET POSITION AND FADES OF LI'S
			actli.css({'left':'0px','top':'0px'});
			nextli.css({'left':'0px','top':'0px'});
			
			/////////////////////////////////////////////
			// SET THE BULLETS SELECTED OR UNSELECTED  //
			/////////////////////////////////////////////
			$('body').find(opt.bulletContainer+" .bullet").each(function() {
				var bul = $(this);
				bul.removeClass("selected");								
				if (bul.index() == opt.next) bul.addClass('selected');
			});
			
			
			//////////////////////////////////////////////////////////////////
			// 		SET THE NEXT CAPTION AND REMOVE THE LAST CAPTION		//
			//////////////////////////////////////////////////////////////////					
					
					container.find('li').each(function() {
						var li = $(this);
						if (li.index!=opt.act && li.index!=opt.next) li.css({'z-index':16});
					});
					
					actli.css({'z-index':18});
					nextli.css({'z-index':20});
					nextli.css({'opacity':0});
			
			
			///////////////////////////
			//	ANIMATE THE CAPTIONS //
			///////////////////////////
			animateTheCaptions(nextli, opt);		
			
			
		

			/////////////////////////////////////////////
			//	SET THE ACTUAL AMOUNT OF SLIDES !!     //
			//  SET A RANDOM AMOUNT OF SLOTS          //
			///////////////////////////////////////////
						if (nextli.data('slotamount')==undefined || nextli.data('slotamount')<1)
							opt.slots=Math.round(Math.random()*12+4);
						else
							opt.slots=nextli.data('slotamount');
			
			
			/////////////////////////////////////
			// THE SLOTSLIDE - TRANSITION I.  //
			////////////////////////////////////
			if (nextli.data('transition')=="slotslide") {
					

						
						nextli.css({'opacity':1});
						
						// PREPARE THE SLOTS HERE
						prepareOneSlide(actsh,opt,true);
						prepareOneSlide(nextsh,opt,false);
						
						//SET DEFAULT IMG UNVISIBLE
						nextsh.find('.defaultimg').css({'opacity':0});
						//actsh.find('.defaultimg').css({'opacity':0});
						
						// ALL OLD SLOTS SHOULD BE SLIDED TO THE RIGHT
						actsh.find('.slotslide').each(function() {
												
							var ss=$(this);				
							ss.cssAnimate({'left':opt.slotw+'px'},{duration:500,queue:false,complete:function() {
													removeSlots(container);
													nextsh.find('.defaultimg').css({'opacity':1});
													actsh.find('.defaultimg').css({'opacity':0});
													opt.act=opt.next;
													opt.transition = 0;				

													
							}});
						}); 
						
						// ALL NEW SLOTS SHOULD BE SLIDED FROM THE LEFT TO THE RIGHT
						nextsh.find('.slotslide').each(function() {
							var ss=$(this);
							ss.css({'left':(0-opt.slotw)+"px"});				
							ss.cssAnimate({'left':'0px'},{duration:500,queue:false,complete:function() {
													removeSlots(container);
													
													actsh.find('.defaultimg').css({'opacity':0});
													nextsh.find('.defaultimg').css({'opacity':1});
													opt.act=opt.next;
													opt.transition = 0;				

													
							}});
						});
			}
			
			
			
			
			
			
			////////////////////////////////////
			// THE SLOTSZOOM - TRANSITION II. //
			////////////////////////////////////						
			if (nextli.data('transition')=="slotzoom") {
						

						nextli.css({'opacity':1});
						
						// PREPARE THE SLOTS HERE
						prepareOneSlide(actsh,opt,true);
						prepareOneSlide(nextsh,opt,true);
						
						//SET DEFAULT IMG UNVISIBLE
						nextsh.find('.defaultimg').css({'opacity':0});
						//actsh.find('.defaultimg').css({'opacity':0});

						// ALL OLD SLOTS SHOULD BE SLIDED TO THE RIGHT
						actsh.find('.slotslide').each(function() {
							var ss=$(this).find('img');				
							
							ss.cssAnimate({'left':(0-opt.slotw/2)+'px',
										   'top':(0-opt.height/2)+'px',
										   'width':(opt.slotw*2)+"px",
										   'height':(opt.height*2)+"px",
										   opacity:0
											},{duration:1000,queue:false,complete:function() {
													removeSlots(container);
													nextsh.find('.defaultimg').css({'opacity':1});
													actsh.find('.defaultimg').css({'opacity':0});
													
													opt.transition = 0;													
													opt.act = opt.next;
											}});
						}); 
						
						
						// ALL NEW SLOTS SHOULD BE SLIDED FROM THE LEFT TO THE RIGHT //
						///////////////////////////////////////////////////////////////
						nextsh.find('.slotslide').each(function(i) {
							var ss=$(this).find('img');
							ss.css({'left':(0)+'px',
									'top':(0)+'px',
									//'width':(opt.width*2)+"px",
									//'height':(opt.height*2)+"px",
									opacity:0});
									
							ss.cssAnimate({'left':(0-i*opt.slotw)+'px',
										   'top':(0)+'px',
										   'width':(nextsh.find('.defaultimg').data('neww'))+"px",
										   'height':(nextsh.find('.defaultimg').data('newh'))+"px",
										   opacity:1
											},{duration:1000,queue:false,complete:function() {
												removeSlots(container);
												
												actsh.find('.defaultimg').css({'opacity':0});
												nextsh.find('.defaultimg').css({'opacity':1});
												opt.transition = 0;
											}});
						});
			}
			
			
			
			
			////////////////////////////////////////
			// THE SLOTSFADE - TRANSITION III.   //
			//////////////////////////////////////
			if (nextli.data('transition')=="slotfade") {
					

					
						nextli.css({'opacity':1});
						
						opt.slots = opt.width/20;
						
						prepareOneSlide(nextsh,opt,true);
						
						
						//actsh.find('.defaultimg').css({'opacity':0});
						nextsh.find('.defaultimg').css({'opacity':0});
						
						var ssamount=0;
						// ALL NEW SLOTS SHOULD BE SLIDED FROM THE LEFT TO THE RIGHT
						nextsh.find('.slotslide').each(function(i) {
							var ss=$(this);
							ssamount++;
							ss.css({'opacity':0});
							ss.data('tout',setTimeout(function() {	
											ss.animate({'opacity':1},{duration:300,queue:false,complete:function() {
												removeSlots(container);
												nextsh.find('.defaultimg').css({'opacity':1});
												actsh.find('.defaultimg').css({'opacity':0});
												opt.transition = 0;													
												opt.act = opt.next;
											}});
											
											},i*4)
									);
							
						});
						
						setTimeout(function() {
									opt.transition = 0;
									opt.act = opt.next;		
									removeSlots(container);
									
									actsh.find('.defaultimg').css({'opacity':0});
									nextsh.find('.defaultimg').css({'opacity':1});
									opt.transition = 0;													
									opt.act = opt.next;
							},(300+(ssamount*4)));
			}
			
			
			
			if (nextli.data('transition')=="fade") {
					

					
						nextli.css({'opacity':1});
						
						opt.slots = 1;
						
						prepareOneSlide(nextsh,opt,true);
						
						
						//actsh.find('.defaultimg').css({'opacity':0});
						nextsh.find('.defaultimg').css({'opacity':0});
						
						var ssamount=0;
						// ALL NEW SLOTS SHOULD BE SLIDED FROM THE LEFT TO THE RIGHT
						nextsh.find('.slotslide').each(function(i) {
							var ss=$(this);
							ssamount++;
							ss.css({'opacity':0});
							ss.animate({'opacity':1},{duration:500,queue:false,complete:function() {
												removeSlots(container);
												
												actsh.find('.defaultimg').css({'opacity':0});
												nextsh.find('.defaultimg').css({'opacity':1});
												opt.transition = 0;													
												opt.act = opt.next;
											}});							
						});
						
						setTimeout(function() {
									opt.transition = 0;
									opt.act = opt.next;									
							},500);
			}
			
			
			
			
			
			if (nextli.data('transition')=="slideleft" || nextli.data('transition')=="slideup" || nextli.data('transition')=="slidedown" || nextli.data('transition')=="slideright") {
					
						nextli.css({'opacity':1});
						
						opt.slots = 1;
						
						prepareOneSlide(nextsh,opt,true);
						prepareOneSlide(actsh,opt,true);
						
						
						actsh.find('.defaultimg').css({'opacity':0});
						nextsh.find('.defaultimg').css({'opacity':0});
						
						
						// ALL NEW SLOTS SHOULD BE SLIDED FROM THE LEFT TO THE RIGHT						
						var ssn=nextsh.find('.slotslide')						
						if (nextli.data('transition')=="slideleft")
							ssn.css({'left':opt.width+"px"});
						else
							if (nextli.data('transition')=="slideright")
								ssn.css({'left':(0-opt.width)+"px"});
							else
								if (nextli.data('transition')=="slideup")
									ssn.css({'top':(opt.height)+"px"});
								else
									if (nextli.data('transition')=="slidedown")
										ssn.css({'top':(0-opt.height)+"px"});
							
						ssn.cssAnimate({'left':'0px','top':'0px',opacity:1},{duration:1000,queue:false,complete:function() {
												removeSlots(container);
												nextsh.find('.defaultimg').css({'opacity':1});
												actsh.find('.defaultimg').css({'opacity':0});
												opt.transition = 0;													
												opt.act = opt.next;
										}});					
										
						
						var ssa=actsh.find('.slotslide');
						
						if (nextli.data('transition')=="slideleft")
							ssa.cssAnimate({'left':(0-opt.width)+'px',opacity:1},{duration:1000,queue:false,complete:function() {
												removeSlots(container);
												nextsh.find('.defaultimg').css({'opacity':1});
												actsh.find('.defaultimg').css({'opacity':0});
												opt.transition = 0;													
												opt.act = opt.next;
											}});
						else
							if (nextli.data('transition')=="slideright")
								ssa.cssAnimate({'left':(opt.width)+'px',opacity:1},{duration:1000,queue:false,complete:function() {
												removeSlots(container);
												nextsh.find('.defaultimg').css({'opacity':1});
												actsh.find('.defaultimg').css({'opacity':0});
												opt.transition = 0;													
												opt.act = opt.next;
											}});
							else
								if (nextli.data('transition')=="slideup")
									ssa.cssAnimate({'top':(0-opt.height)+'px',opacity:1},{duration:1000,queue:false,complete:function() {
												removeSlots(container);
												nextsh.find('.defaultimg').css({'opacity':1});
												actsh.find('.defaultimg').css({'opacity':0});
												opt.transition = 0;													
												opt.act = opt.next;
											}});
								else
									if (nextli.data('transition')=="slidedown")
										ssa.cssAnimate({'top':(opt.height)+'px',opacity:1},{duration:1000,queue:false,complete:function() {
												removeSlots(container);
												nextsh.find('.defaultimg').css({'opacity':1});
												actsh.find('.defaultimg').css({'opacity':0});
												opt.transition = 0;													
												opt.act = opt.next;
											}});
						
						
						
						
			}
			
		
						
		}
		
		
		
		
			////////////////////////
			// SHOW THE CAPTION  //
			///////////////////////		
				function animateTheCaptions(nextli, opt) {
						
						nextli.find('.caption').each(function(i) {
								
								var nextcaption=nextli.find('.caption:eq('+i+')');																															
								nextcaption.stop(true,true);
						
							   var imw =0;
							   var imh = 0;
							   
										if (nextcaption.find('img').length>0) {
											var im = nextcaption.find('img');
											if (im.data('ww') == undefined) im.data('ww',im.width());
											if (im.data('hh') == undefined) im.data('hh',im.height());
											
											var ww = im.data('ww');
											var hh = im.data('hh');
											
											
											im.width(ww*opt.bw);
											im.height(hh*opt.bh);
											imw = im.width();
											imh = im.height();
										} else {
											var nc =nextcaption;
											if (nc.data('fsize') == undefined) nc.data('fsize',parseInt(nc.css('font-size'),0) || 0);
											if (nc.data('pt') == undefined) nc.data('pt',parseInt(nc.css('paddingTop'),0) || 0);
											if (nc.data('pb') == undefined) nc.data('pb',parseInt(nc.css('paddingBottom'),0) || 0);
											if (nc.data('pl') == undefined) nc.data('pl',parseInt(nc.css('paddingLeft'),0) || 0);
											if (nc.data('pr') == undefined) nc.data('pr',parseInt(nc.css('paddingRight'),0) || 0);
											
											if (nc.data('mt') == undefined) nc.data('mt',parseInt(nc.css('marginTop'),0) || 0);
											if (nc.data('mb') == undefined) nc.data('mb',parseInt(nc.css('marginBottom'),0) || 0);
											if (nc.data('ml') == undefined) nc.data('ml',parseInt(nc.css('marginLeft'),0) || 0);
											if (nc.data('mr') == undefined) nc.data('mr',parseInt(nc.css('marginRight'),0) || 0);
											
											if (nc.data('bt') == undefined) nc.data('bt',parseInt(nc.css('borderTop'),0) || 0);
											if (nc.data('bb') == undefined) nc.data('bb',parseInt(nc.css('borderBottom'),0) || 0);
											if (nc.data('bl') == undefined) nc.data('bl',parseInt(nc.css('borderLeft'),0) || 0);
											if (nc.data('br') == undefined) nc.data('br',parseInt(nc.css('borderRight'),0) || 0);
											
											
											nextcaption.css({
															 'font-size': (nc.data('fsize') * opt.bw)+"px",
															
															 'padding-top': (nc.data('pt') * opt.bh) + "px",
															 'padding-bottom': (nc.data('pb') * opt.bh) + "px",
															 'padding-left': (nc.data('pl') * opt.bw) + "px",
															 'padding-right': (nc.data('pr') * opt.bw) + "px",
															 
															 'margin-top': (nc.data('mt') * opt.bh) + "px",
															 'margin-bottom': (nc.data('mb') * opt.bh) + "px",
															 'margin-left': (nc.data('ml') * opt.bw) + "px",
															 'margin-right': (nc.data('mr') * opt.bw) + "px",
															 
															 'border-top': (nc.data('bt') * opt.bh) + "px",
															 'border-bottom': (nc.data('bb') * opt.bh) + "px",
															 'border-left': (nc.data('bl') * opt.bw) + "px",
															 'border-right': (nc.data('br') * opt.bw) + "px",
															 
											});
											
										}
								
										
								
								if (nextcaption.hasClass('fade')) {																						
									nextcaption.css({'opacity':0});
								}
								
								
								
								if (nextcaption.hasClass('lfr')) {
									
									nextcaption.css({'opacity':1,'left':opt.width+'px','top':(opt.bh*nextcaption.data('y'))+"px"});
									
								}
								
								if (nextcaption.hasClass('lfl')) {
									nextcaption.css({'opacity':1,'left':(0-imw)+'px','top':(opt.bh*nextcaption.data('y'))+"px"});
									
								}
								
								if (nextcaption.hasClass('sfl')) {
									nextcaption.css({'opacity':0,'left':((opt.bw*nextcaption.data('x'))-50)+'px','top':(opt.bh*nextcaption.data('y'))+"px"});
								}
								
								if (nextcaption.hasClass('sfr')) {
									nextcaption.css({'opacity':0,'left':((opt.bw*nextcaption.data('x'))+50)+'px','top':(opt.bh*nextcaption.data('y'))+"px"});
								}
								
								
								
								
								if (nextcaption.hasClass('lft')) {
									
									nextcaption.css({'opacity':1,'left':(opt.bw*nextcaption.data('x'))+'px','top':(0 - imh)+"px"});
									
								}
								
								if (nextcaption.hasClass('lfb')) {
									nextcaption.css({'opacity':1,'left':(opt.bw*nextcaption.data('x'))+'px','top':opt.height+"px"});
									
								}
								
								if (nextcaption.hasClass('sft')) {
									nextcaption.css({'opacity':0,'left':(opt.bw*nextcaption.data('x'))+'px','top':((opt.bh*nextcaption.data('y'))-50)+"px"});
								}
								
								if (nextcaption.hasClass('sfb')) {
									nextcaption.css({'opacity':0,'left':(opt.bw*nextcaption.data('x'))+'px','top':((opt.bh*nextcaption.data('y'))+50)+"px"});
								}
								
								
								
								
								setTimeout(function() { 
										if (nextcaption.hasClass('fade')) {																						
											nextcaption.animate({'opacity':1});
										}
										if (nextcaption.hasClass('lfr') || 
											nextcaption.hasClass('lfl') || 
											nextcaption.hasClass('sfr') || 
											nextcaption.hasClass('sfl') ||
											nextcaption.hasClass('lft') || 
											nextcaption.hasClass('lfb') || 
											nextcaption.hasClass('sft') || 
											nextcaption.hasClass('sfb')
											) 
										{											
											nextcaption.animate({'opacity':1,'left':(opt.bw*nextcaption.data('x'))+'px','top':opt.bh*(nextcaption.data('y'))+"px"},{duration:nextcaption.data('speed')});
										}
								},nextcaption.data('start'));
								
						})
				}
		
		
		///////////////////////////
		//	-	COUNTDOWN	-	//
		/////////////////////////
		function countDown(container,opt) {
			opt.cd=0;
			if (opt.delay>0) {
				var bt=container.find('.bannertimer');				
				if (bt.length>0) {
					bt.css({'display':'none'});
					bt.css({'width':'0%'});
					bt.animate({'width':"100%"},{duration:(opt.delay-100),queue:false, easing:"linear"});
				}
				opt.cdint=setInterval(function() {
					
					opt.cd=opt.cd+100;
					
					
					
					if (opt.cd>=opt.delay) {
						opt.cd=0;
						// SWAP TO NEXT BANNER 
						opt.act=opt.next;
						opt.next=opt.next+1;
						if (opt.next>container.find('>ul >li').length-1) opt.next=0;
						
						
						// SWAP THE SLIDES
						swapSlide(container,opt);
						
						// Clear the Timer
						if (bt.length>0) {
							bt.css({'width':'0%'});
							bt.animate({'width':"100%"},{duration:(opt.delay-100),queue:false, easing:"linear"});
						}
					}
				},100);
			};
		}

		
		
})(jQuery);			

				
			

			   